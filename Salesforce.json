{
  "salesforce": {
    "meta": {
      "lead": {
        "apiName": "Lead",
        "idProperty": "Id"
      },
      "contact": {
        "apiName": "Contact",
        "idProperty": "Id"
      },
      "account": {
        "apiName": "Account",
        "idProperty": "Id"
      },
      "campaignMember": {
        "apiName": "CampaignMember",
        "idProperty": "Id"
      },
      "task": {
        "apiName": "Task",
        "idProperty": "Id"
      }
    },
    "defaultExport": {
      "mappings": {
        "lead": {
          "LeadSource": "{{  }}",
          "LastName": "{{ lastName }}",
          "FirstName": "{{ firstName }}",
          "Salutation": "{{ execute(salutationFunction) }}",
          "Title": "{{ position }}",
          "Company": "{{ organization }}",
          "Street": "{{ street }}",
          "City": "{{ city }}",
          "State": "{{ state }}",
          "PostalCode": "{{ zip }}",
          "Country": "{{ country }}",
          "Phone": "{{ phone }}",
          "MobilePhone": "{{ mobile }}",
          "Fax": "{{ fax }}",
          "Email": "{{ email }}",
          "Website": "{{ website }}",
          "Status": "{{  }}",
          "RecordTypeId": "{{  }}"
        },
        "contact": {
          "LastName": "{{ lastName }}",
          "FirstName": "{{ firstName }}",
          "Title": "{{ position }}",
          "Salutation": "{{ execute(salutationFunction) }}",
          "MailingStreet": "{{ street }}",
          "MailingCity": "{{ city }}",
          "MailingState": "{{ state }}",
          "MailingPostalCode": "{{ zip }}",
          "MailingCountry": "{{ country }}",
          "MobilePhone": "{{ mobile }}",
          "Phone": "{{ phone }}",
          "Fax": "{{ fax }}",
          "Email": "{{ email }}",
          "RecordTypeId": "{{  }}"
        },
        "account": {
          "Name": "{{ organization }}",
          "RecordTypeId": "{{  }}",
          "BillingStreet": "{{ street }}",
          "BillingCity": "{{ city }}",
          "BillingState": "{{ state }}",
          "BillingPostalCode": "{{ zip }}",
          "BillingCountry": "{{ country }}",
          "ShippingStreet": "{{ street }}",
          "ShippingCity": "{{ city }}",
          "ShippingState": "{{ state }}",
          "ShippingPostalCode": "{{ zip }}",
          "ShippingCountry": "{{ country }}",
          "Phone": "{{ phone || mobile }}",
          "Fax": "{{ fax }}",
          "Website": "{{ website }}"
        },
        "note": {
          "note": "{{ note }}"
        }
      },
      "workflows": {
        "lead": [
          {
            "entity": "lead"
          },
          {
            "entity": "attachments",
            "config": {
              "bcImage": {
                "entities": [
                  "lead"
                ],
                "name": "Business card front"
              },
              "bcImageBackside": {
                "entities": [
                  "lead"
                ],
                "name": "Business card back"
              },
              "drawing": {
                "entities": [
                  "lead"
                ],
                "name": "Drawing"
              },
              "image": {
                "entities": [
                  "lead"
                ],
                "name": "Profile image"
              },
              "attachments": {
                "entities": [
                  "lead"
                ],
                "name": {
                  "*": "Attachment (${i})",
                  "PDF": "Attachment (${i})",
                  "SIGNATURE": "{{ visitreport.title || '' }} - {{ firstName || '' }} {{ lastName || '' }} Signatur.pdf"
                }
              },
              "note": {
                "entities": [
                  "lead"
                ],
                "name": "Note"
              }
            }
          }
        ],
        "contact_account": [
          {
            "entity": "account"
          },
          {
            "entity": "contact",
            "dependsOn": [
              {
                "field": "AccountId",
                "entity": "account"
              }
            ]
          },
          {
            "entity": "attachments",
            "config": {
              "bcImage": {
                "entities": [
                  "contact"
                ],
                "name": "Business card front"
              },
              "bcImageBackside": {
                "entities": [
                  "contact"
                ],
                "name": "Business card back"
              },
              "drawing": {
                "entities": [
                  "contact"
                ],
                "name": "Drawing"
              },
              "image": {
                "entities": [
                  "contact"
                ],
                "name": "Profile image"
              },
              "attachments": {
                "entities": [
                  "contact"
                ],
                "name": {
                  "*": "Attachment (${i})",
                  "PDF": "Attachment (${i})",
                  "SIGNATURE": "{{ visitreport.title || '' }} - {{ firstName || '' }} {{ lastName || '' }} Signatur"
                }
              },
              "note": {
                "entities": [
                  "contact"
                ],
                "name": "Note"
              }
            }
          }
        ]
      },
      "components": {
        "lead": [],
        "contact_account": []
      }
    },
    "visitreport": {
      "mappings": {
        "*": {
          "lead": {
            "LeadSource": "{{  }}",
            "LastName": "{{ lastName }}",
            "FirstName": "{{ firstName }}",
            "Salutation": "{{ execute(salutationFunction) }}",
            "Title": "{{ position }}",
            "Company": "{{ organization }}",
            "Street": "{{ street }}",
            "City": "{{ city }}",
            "State": "{{ state }}",
            "PostalCode": "{{ zip }}",
            "Country": "{{ country }}",
            "Phone": "{{ phone }}",
            "MobilePhone": "{{ mobile }}",
            "Fax": "{{ fax }}",
            "Email": "{{ email }}",
            "Website": "{{ website }}",
            "Status": "{{  }}",
            "RecordTypeId": "{{  }}"
          },
          "contact": {
            "LastName": "{{ lastName }}",
            "FirstName": "{{ firstName }}",
            "Title": "{{ position }}",
            "Salutation": "{{ execute(salutationFunction) }}",
            "MailingStreet": "{{ street }}",
            "MailingCity": "{{ city }}",
            "MailingState": "{{ state }}",
            "MailingPostalCode": "{{ zip }}",
            "MailingCountry": "{{ country }}",
            "MobilePhone": "{{ mobile }}",
            "Phone": "{{ phone }}",
            "Fax": "{{ fax }}",
            "Email": "{{ email }}",
            "RecordTypeId": "{{  }}"
          },
          "account": {
            "Name": "{{ organization }}",
            "RecordTypeId": "{{  }}",
            "BillingStreet": "{{ street }}",
            "BillingCity": "{{ city }}",
            "BillingState": "{{ state }}",
            "BillingPostalCode": "{{ zip }}",
            "BillingCountry": "{{ country }}",
            "ShippingStreet": "{{ street }}",
            "ShippingCity": "{{ city }}",
            "ShippingState": "{{ state }}",
            "ShippingPostalCode": "{{ zip }}",
            "ShippingCountry": "{{ country }}",
            "Phone": "{{ phone || mobile }}",
            "Fax": "{{ fax }}",
            "Website": "{{ website }}"
          },
          "campaignMember": {
            "CampaignId": "{{ visitreport.campaignId }}"
          },
          "note": {
            "note": "{{ execute(getVisitReportNote) }}"
          }
        }
      },
      "workflows": {
        "*": {
          "lead": [
            {
              "entity": "lead"
            },
            {
              "entity": "attachments",
              "config": {
                "bcImage": {
                  "entities": [
                    "lead"
                  ],
                  "name": "Business card front"
                },
                "bcImageBackside": {
                  "entities": [
                    "lead"
                  ],
                  "name": "Business card back"
                },
                "visitreport_pdf": {
                  "entities": [
                    "lead"
                  ],
                  "name": "VisitReport"
                },
                "drawing": {
                  "entities": [
                    "lead"
                  ],
                  "name": "Drawing"
                },
                "image": {
                  "entities": [
                    "lead"
                  ],
                  "name": "Profile image"
                },
                "attachments": {
                  "entities": [
                    "lead"
                  ],
                  "name": {
                    "*": "Attachment (${i})",
                    "PDF": "Attachment (${i})",
                    "SIGNATURE": "{{ visitreport.title || '' }} - {{ firstName || '' }} {{ lastName || '' }} Signatur"
                  }
                },
                "note": {
                  "entities": [
                    "lead"
                  ],
                  "name": "Note"
                }
              }
            }
          ],
          "contact_account": [
            {
              "entity": "account"
            },
            {
              "entity": "contact",
              "dependsOn": [
                {
                  "field": "AccountId",
                  "entity": "account"
                }
              ]
            },
            {
              "entity": "attachments",
              "config": {
                "bcImage": {
                  "entities": [
                    "contact"
                  ],
                  "name": "Business card front"
                },
                "visitreport_pdf": {
                  "entities": [
                    "contact"
                  ],
                  "name": "VisitReport"
                },
                "bcImageBackside": {
                  "entities": [
                    "contact"
                  ],
                  "name": "Business card back"
                },
                "drawing": {
                  "entities": [
                    "contact"
                  ],
                  "name": "Drawing"
                },
                "image": {
                  "entities": [
                    "contact"
                  ],
                  "name": "Profile image"
                },
                "attachments": {
                  "entities": [
                    "contact"
                  ],
                  "name": {
                    "*": "Attachment (${i})",
                    "PDF": "Attachment (${i})",
                    "SIGNATURE": "{{ visitreport.title || '' }} - {{ firstName || '' }} {{ lastName || '' }} Signatur"
                  }
                },
                "note": {
                  "entities": [
                    "contact"
                  ],
                  "name": "Note"
                }
              }
            }
          ]
        }
      },
      "components": {
        "*": {
          "lead": [],
          "contact_account": []
        }
      }
    },
    "code": {
      "functions": {
        "salutationFunction": [
          "if (address.gender === 0) {",
          "  return 'Herr';",
          "} else if (address.gender === 1) {",
          "  return 'Frau';",
          "} else {",
          "  return '';",
          "}"
        ],
        "getVisitReportNote": [
           "var note = address.note ? (address.note + '\\n\\n') : '';",
          "if (address.visitreport && address.visitreport.result) {",
          "  note += 'VisitReport\\n\\n';",
          "  var result = address.visitreport.result;",
          "  for (var key in result) {",
          "    note += result[key].question + ' = ' + (result[key].text || '-') + '\n';",
          "  }",
          "}",
          "return note.replace(/\"/g,'');"
        ]
      }
    }
  }
}